#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2026/1/30# @Author : cyq# @File : __init__.py# @Software: PyCharm# @Desc:from dataclasses import dataclass, fieldfrom typing import Optionalfrom playwright.async_api import Pagefrom app.model.playUI import PlayStepModel, PlayCaseResult, PlayCase, PlayTaskResultfrom app.model.playUI.playStepContent import PlayStepContentfrom croe.interface.manager.variable_manager import VariableManagerfrom croe.play.browser import PageManagerfrom croe.play.starter import UIStarterfrom utils import log@dataclassclass StepContext:    step: PlayStepModel    starter: UIStarter    variable_manager: VariableManager    page_manager: Optional[PageManager] = None    @property    def page(self) -> Page:        """获取当前活动页面"""        if self.page_manager:            return self.page_manager.current_page        raise RuntimeError("PageManager not initialized")    @property    def selector(self) -> Optional[str]:        return self.step.selector    @property    def locator(self) -> Optional[str]:        return self.step.locator if self.step.locator else None    @property    def method(self) -> Optional[str]:        return self.step.method    @property    def value(self) -> Optional[str]:        return self.step.value.strip() if self.step.value else None    @property    def key(self):        return self.step.key.strip() if self.step.key else "None"    async def log(self, msg: str):        await self.starter.send(msg)@dataclassclass StepContentContext:    index: int    play_step_content: PlayStepContent    starter: UIStarter    variable_manager: VariableManager    page_manager: Optional[PageManager] = field(default=None)    @property    def page(self) -> Optional[Page]:        if self.page_manager:            return self.page_manager.current_page        raise RuntimeError("PageManager not initialized")    def __repr__(self):        return f"<StepContentContext {self.index} {self.play_step_content.content_type} />"@dataclassclass PlayExecutionContext:    """    执行上下文    """    play_case: PlayCase    starter: UIStarter    case_result: Optional[PlayCaseResult] = None    task_result: Optional[PlayTaskResult] = None__all__ = [    "StepContext",    "StepContentContext",    "PlayExecutionContext"]