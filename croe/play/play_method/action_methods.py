#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2026/1/30# @Author : cyq# @File : page_methods# @Software: PyCharm# @Desc: https://playwright.dev/python/docs/api/class-locator#locator-allfrom playwright.async_api import Locatorfrom croe.play.context import StepContextfrom ._base_method import BaseMethodsclass ClickMethod(BaseMethods):    """    click    """    name = "click"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.click()        await context.log(f"[ClickMethod] click")class BlurMethod(BaseMethods):    """    Blur the element.    """    name = "blur"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.blur()        await context.log(f"[BlurMethod] blur")class DblclickMethod(BaseMethods):    """     Double-click on the element.    """    name = "dblclick"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.dblclick()        await context.log(f"[DblclickMethod] dblclick")class CheckMethod(BaseMethods):    """    Check the checkbox if it's not checked    """    name = "check"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.check()        await context.log(f"[CheckMethod] check")class UncheckMethod(BaseMethods):    """    Uncheck the checkbox if it's checked    """    name = "uncheck"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.uncheck()        await context.log(f"[UncheckMethod] uncheck")class ClearMethod(BaseMethods):    """    Clear the input field    """    name = "clear"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.clear()        await context.log(f"[ClearMethod] clear")class CountMethod(BaseMethods):    """    Get the number of elements matching selector.    """    name = "count"    async def execute(self, locator: Locator, context: StepContext) -> None:        key = context.step.value        count = await locator.count()        if not count:            count = 0        await context.variable_manager.add_var(key, count)        await context.log(f"[CountMethod] count {key}:{count} add to vars")class EvaluateMethod(BaseMethods):    """     Evaluates the given function in the page's context and returns the result.    """    name = "evaluate"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await context.variable_manager.trans(context.value.strip())        result = await locator.evaluate(value)        await context.log(f"[EvaluateMethod] evaluate {value}")        if result:            await context.variable_manager.add_var(context.step.value, result)class FocusMethod(BaseMethods):    """    Focus the element.    """    name = "focus"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.focus()        await context.log(f"[FocusMethod] focus")class FillMethod(BaseMethods):    """     Value to set for the <input>, <textarea> or [contenteditable] element.    """    name = "fill"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await context.variable_manager.trans(context.value.strip())        await locator.fill(value=context.value)        await context.log(f"[FillMethod] fill value {value}")class GetAttributeMethod(BaseMethods):    """    Get an attribute of the element.    """    name = "get_attribute"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await locator.get_attribute(name=context.value)        await context.variable_manager.add_var(context.step.value, value)        await context.log(f"[GetAttributeMethod] get attribute {context.value}")class GetInnerTextMethod(BaseMethods):    """    Get the inner text of the element.    """    name = "get_inner_text"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await locator.inner_text()        await context.variable_manager.add_var(context.step.value, value)        await context.log(f"[GetInnerTextMethod] get inner text {value}")class GetInputValueMethod(BaseMethods):    """    Get the value of the input element.    """    name = "get_input_value"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await locator.input_value()        await context.variable_manager.add_var(context.step.value, value)        await context.log(f"[GetInputValueMethod] get input value {value}")class GetTextContentMethod(BaseMethods):    """    Get the text content of the element.    """    name = "get_text_content"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await locator.text_content()        await context.variable_manager.add_var(context.step.value, value)        await context.log(f"[GetTextContentMethod] get text content {value}")class SelectOptionLabelMethod(BaseMethods):    """    Select an option in a <select> element.    """    name = "select_option_label"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await context.variable_manager.trans(context.value.strip())        await locator.select_option(label=value)        await context.log(f"[SelectOptionMethod] select option label {value}")class SelectOptionValueMethod(BaseMethods):    """    Select an option in a <select> element.    """    name = "select_option_value"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await context.variable_manager.trans(context.value.strip())        await locator.select_option(value=value)        await context.log(f"[SelectOptionMethod] select option value {value}")class SelectOptionValuesMethod(BaseMethods):    """    Select an option in a <select> element.    """    name = "select_option_values"    async def execute(self, locator: Locator, context: StepContext) -> None:        value = await context.variable_manager.trans(context.value.strip())        values = value.split(",")        await locator.select_option(value=values)        await context.log(f"[SelectOptionMethod] select option values {values}")class SetCheckedMethod(BaseMethods):    """    Set the checked state of the checkbox.    """    name = "set_checked"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.set_checked(True)        await context.log(f"[SetCheckedMethod] set checked ")class SetUncheckedMethod(BaseMethods):    """    Set the checked state of the checkbox.    """    name = "set_unchecked"    async def execute(self, locator: Locator, context: StepContext) -> None:        await locator.set_checked(False)        await context.log(f"[SetUncheckedMethod] set unchecked ")__all__ = (    "ClickMethod",    "BlurMethod",    "DblclickMethod",    "CheckMethod",    "UncheckMethod",    "ClearMethod",    "CountMethod",    "EvaluateMethod",    "FocusMethod",    "FillMethod",    "GetAttributeMethod",    "GetInnerTextMethod",    "GetInputValueMethod",    "GetTextContentMethod",    "SelectOptionLabelMethod",    "SelectOptionValueMethod",    "SelectOptionValuesMethod",    "SetCheckedMethod",    "SetUncheckedMethod")