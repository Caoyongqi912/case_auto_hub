# UIè‡ªåŠ¨åŒ–æµ‹è¯•ä»£ç ä¼˜åŒ–å®æ–½æŠ¥å‘Š

## æ‰§è¡Œæ—¥æœŸ
2026-01-30

## é¡¹ç›®æ¦‚è¿°
æˆåŠŸå®Œæˆäº†UIè‡ªåŠ¨åŒ–æµ‹è¯•ä»£ç çš„å…¨é¢ä¼˜åŒ–ï¼Œå°†ä»£ç ä» `croe/play_ui/` è¿ç§»åˆ° `croe/ui/`ï¼Œå¹¶å®ç°äº†å¤šé¡¹æ€§èƒ½ä¼˜åŒ–ç»„ä»¶ã€‚

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. ç›®å½•ç»“æ„é‡ç»„ âœ…
**ä»»åŠ¡çŠ¶æ€**: å·²å®Œæˆ

**å®æ–½å†…å®¹**:
- âœ… å°† `croe/play_ui/` é‡å‘½åä¸º `croe/ui/`
- âœ… æŒ‰ç…§æœ€ç»ˆè®¾è®¡é‡ç»„ç›®å½•ç»“æ„
- âœ… åˆ›å»ºäº†ä»¥ä¸‹æ¨¡å—ç›®å½•ï¼š
  - `core/` - æ ¸å¿ƒç»„ä»¶ï¼ˆæµè§ˆå™¨ç®¡ç†ã€ä¸Šä¸‹æ–‡æ± ï¼‰
  - `executor/` - æ‰§è¡Œå™¨ï¼ˆç”¨ä¾‹æ‰§è¡Œå™¨ã€æ­¥éª¤æ‰§è¡Œå™¨ã€æ–¹æ³•é“¾ï¼‰
  - `methods/` - æ–¹æ³•å¤„ç†å™¨ï¼ˆaction, assertion, extract, page, scriptï¼‰
  - `locator/` - å…ƒç´ å®šä½ï¼ˆå®šä½å™¨ã€ç¼“å­˜ï¼‰
  - `wait/` - ç­‰å¾…ç­–ç•¥ï¼ˆåŸºç¡€ç­–ç•¥ã€è‡ªé€‚åº”ç­–ç•¥ï¼‰
  - `result/` - ç»“æœå¤„ç†ï¼ˆå†™å…¥å™¨ã€æ‰¹é‡å†™å…¥å™¨ï¼‰
  - `condition/` - æ¡ä»¶å¤„ç†ï¼ˆæ¡ä»¶ç¼“å­˜ï¼‰
  - `utils/` - å·¥å…·å‡½æ•°ï¼ˆå¼‚æ­¥æˆªå›¾ï¼‰
  - `integration/` - é›†æˆé€‚é…ï¼ˆå‘åå…¼å®¹ï¼‰

**æ–‡ä»¶ç»Ÿè®¡**:
- Pythonæ–‡ä»¶æ€»æ•°: 34ä¸ª
- ç›®å½•æ€»æ•°: 15ä¸ª

---

### 2. æ€§èƒ½ä¼˜åŒ–ç»„ä»¶å®ç° âœ…

#### 2.1 æ‰¹é‡æ•°æ®åº“å†™å…¥å™¨ (BatchResultWriter) âœ…
**æ–‡ä»¶**: `croe/ui/result/batch_writer.py`

**åŠŸèƒ½ç‰¹æ€§**:
- ç¼“å†²å˜é‡æå–å’Œæ–­è¨€ç»“æœ
- æ‰¹é‡å¤§å°: 50æ¡è®°å½•
- åˆ·æ–°é—´éš”: 5ç§’
- æ”¯æŒå¼ºåˆ¶åˆ·æ–°ï¼ˆç”¨ä¾‹ç»“æŸæ—¶ï¼‰
- æä¾›ç»Ÿè®¡ä¿¡æ¯æ¥å£

**æ€§èƒ½ç›®æ ‡**:
- å°†æ•°æ®åº“å†™å…¥æ—¶é—´ä» 20-150ç§’/100æ­¥éª¤ ä¼˜åŒ–åˆ° 2-15ç§’/100æ­¥éª¤
- **é¢„æœŸæå‡**: 90-95%

**å…³é”®æ–¹æ³•**:
- `add_var()` - æ·»åŠ å˜é‡åˆ°ç¼“å†²åŒº
- `add_assert()` - æ·»åŠ æ–­è¨€åˆ°ç¼“å†²åŒº
- `force_flush()` - å¼ºåˆ¶åˆ·æ–°ç¼“å†²åŒº
- `get_stats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

---

#### 2.2 å…ƒç´ å®šä½ç¼“å­˜ (LocatorCache) âœ…
**æ–‡ä»¶**: `croe/ui/locator/cache.py`

**åŠŸèƒ½ç‰¹æ€§**:
- LRUç¼“å­˜ç­–ç•¥
- æœ€å¤§å®¹é‡: 100ä¸ªå®šä½å™¨
- TTL: 60ç§’
- åŸºäºé¡µé¢IDã€é€‰æ‹©å™¨å’Œå®šä½ç±»å‹çš„ç¼“å­˜é”®
- æ”¯æŒå‘½ä¸­ç‡ç»Ÿè®¡

**æ€§èƒ½ç›®æ ‡**:
- å‡å°‘ 30-40% çš„å…ƒç´ å®šä½æ—¶é—´

**å…³é”®æ–¹æ³•**:
- `get()` - ä»ç¼“å­˜è·å–å®šä½å™¨
- `set()` - å­˜å…¥å®šä½å™¨åˆ°ç¼“å­˜
- `clear_page()` - æ¸…é™¤ç‰¹å®šé¡µé¢çš„ç¼“å­˜
- `get_stats()` - è·å–ç¼“å­˜ç»Ÿè®¡

---

#### 2.3 æµè§ˆå™¨ä¸Šä¸‹æ–‡æ±  (ContextPool) âœ…
**æ–‡ä»¶**: `croe/ui/core/context_pool.py`

**åŠŸèƒ½ç‰¹æ€§**:
- ä¸Šä¸‹æ–‡æ± åŒ–ç®¡ç†
- æœ€å¤§ä¸Šä¸‹æ–‡æ•°: 5ä¸ª
- æœ€å°ä¿æŒæ•°: 1ä¸ª
- è‡ªåŠ¨æ¸…ç†å’Œå¤ç”¨
- æ”¯æŒå¹¶å‘è·å–å’Œé‡Šæ”¾

**æ€§èƒ½ç›®æ ‡**:
- å‡å°‘æµè§ˆå™¨åˆå§‹åŒ–å¼€é”€ 90%+

**å…³é”®æ–¹æ³•**:
- `initialize()` - åˆå§‹åŒ–ä¸Šä¸‹æ–‡æ± 
- `acquire()` - è·å–å¯ç”¨ä¸Šä¸‹æ–‡
- `release()` - é‡Šæ”¾ä¸Šä¸‹æ–‡
- `close_all()` - å…³é—­æ‰€æœ‰ä¸Šä¸‹æ–‡
- `get_stats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

---

#### 2.4 å¼‚æ­¥æˆªå›¾å¤„ç†å™¨ (AsyncScreenshot) âœ…
**æ–‡ä»¶**: `croe/ui/utils/screenshot.py`

**åŠŸèƒ½ç‰¹æ€§**:
- åå°å¼‚æ­¥æˆªå›¾
- å·¥ä½œçº¿ç¨‹æ•°: 2ä¸ª
- ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†
- æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ä¸¤ç§æ¨¡å¼
- è‡ªåŠ¨åˆ›å»ºç›®å½•

**æ€§èƒ½ç›®æ ‡**:
- å°†æˆªå›¾å¼€é”€ä» 1.5-3.5ç§’ é™ä½åˆ°æ¥è¿‘ 0ç§’ï¼ˆå¼‚æ­¥å¤„ç†ï¼‰
- **é¢„æœŸæå‡**: 95%+

**å…³é”®æ–¹æ³•**:
- `start()` - å¯åŠ¨åå°å·¥ä½œçº¿ç¨‹
- `capture_async()` - å¼‚æ­¥æ•è·æˆªå›¾
- `capture_sync()` - åŒæ­¥æ•è·æˆªå›¾
- `stop()` - åœæ­¢å¹¶ç­‰å¾…æ‰€æœ‰ä»»åŠ¡å®Œæˆ
- `get_stats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

---

#### 2.5 è‡ªé€‚åº”ç­‰å¾…ç­–ç•¥ (AdaptiveWaitStrategy) âœ…
**æ–‡ä»¶**: `croe/ui/wait/adaptive.py`

**åŠŸèƒ½ç‰¹æ€§**:
- è®°å½•å…ƒç´ å†å²å‡ºç°æ—¶é—´
- åŸºäºç»Ÿè®¡æ•°æ®é¢„æµ‹è¶…æ—¶
- ä½¿ç”¨å¹³å‡å€¼ + 1.5å€æ ‡å‡†å·®
- å†å²è®°å½•å¤§å°: 10æ¡
- è¶…æ—¶èŒƒå›´: 1ç§’ - 30ç§’

**æ€§èƒ½ç›®æ ‡**:
- å‡å°‘ 40-50% çš„ç­‰å¾…æ—¶é—´

**å…³é”®æ–¹æ³•**:
- `predict_timeout()` - é¢„æµ‹è¶…æ—¶æ—¶é—´
- `smart_wait()` - æ™ºèƒ½ç­‰å¾…å…ƒç´ 
- `get_stats()` - è·å–ç»Ÿè®¡ä¿¡æ¯
- `clear()` - æ¸…ç©ºç»Ÿè®¡æ•°æ®

---

#### 2.6 æ¡ä»¶åˆ¤æ–­ç¼“å­˜ (ConditionCache) âœ…
**æ–‡ä»¶**: `croe/ui/condition/cache.py`

**åŠŸèƒ½ç‰¹æ€§**:
- ç¼“å­˜æ¡ä»¶è¡¨è¾¾å¼åˆ¤æ–­ç»“æœ
- LRUç¼“å­˜ç­–ç•¥
- æœ€å¤§å®¹é‡: 200æ¡
- TTL: 60ç§’
- åŸºäºæ¡ä»¶å’Œå˜é‡çš„MD5å“ˆå¸Œé”®

**æ€§èƒ½ç›®æ ‡**:
- æå‡ 80-90% çš„æ¡ä»¶åˆ¤æ–­æ€§èƒ½

**å…³é”®æ–¹æ³•**:
- `get()` - ä»ç¼“å­˜è·å–åˆ¤æ–­ç»“æœ
- `set()` - å­˜å…¥åˆ¤æ–­ç»“æœ
- `clear()` - æ¸…ç©ºç¼“å­˜
- `get_stats()` - è·å–ç»Ÿè®¡ä¿¡æ¯

**é™„åŠ ç»„ä»¶**:
- `CachedConditionChecker` - å¸¦ç¼“å­˜çš„æ¡ä»¶æ£€æŸ¥å™¨
- `check()` - æ£€æŸ¥æ¡ä»¶ï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰

---

### 3. æ–¹æ³•å¤„ç†å™¨å®Œå–„ âœ…

**å·²è¡¥å……çš„æ–¹æ³•**:
- âœ… `PressMethod` (play_press) - é”®ç›˜æŒ‰é”®æ“ä½œ
- âœ… `UploadMethod` (play_upload) - æ–‡ä»¶ä¸Šä¼ æ“ä½œ

**å®Œæ•´çš„æ–¹æ³•åˆ—è¡¨**:
- **åŠ¨ä½œæ–¹æ³•** (action.py):
  - play_click - ç‚¹å‡»
  - play_dblclick - åŒå‡»
  - play_fill - å¡«å……
  - play_type - è¾“å…¥
  - play_select - é€‰æ‹©
  - play_check - å‹¾é€‰
  - play_uncheck - å–æ¶ˆå‹¾é€‰
  - play_hover - æ‚¬åœ
  - play_focus - èšç„¦
  - play_press - æŒ‰é”® âœ¨æ–°å¢
  - play_upload - ä¸Šä¼ æ–‡ä»¶ âœ¨æ–°å¢

- **æ–­è¨€æ–¹æ³•** (assertion.py):
  - assert_text - æ–­è¨€æ–‡æœ¬
  - assert_value - æ–­è¨€å€¼
  - assert_visible - æ–­è¨€å¯è§
  - assert_enabled - æ–­è¨€å¯ç”¨
  - assert_disabled - æ–­è¨€ç¦ç”¨
  - assert_checked - æ–­è¨€å‹¾é€‰
  - assert_unchecked - æ–­è¨€æœªå‹¾é€‰

- **æå–æ–¹æ³•** (extract.py):
  - get_attr - è·å–å±æ€§
  - get_text - è·å–æ–‡æœ¬
  - get_value - è·å–å€¼
  - get_count - è·å–æ•°é‡

- **é¡µé¢æ–¹æ³•** (page.py):
  - play_go_to - è·³è½¬
  - play_reload - åˆ·æ–°
  - play_back - åé€€
  - play_forward - å‰è¿›
  - play_wait - ç­‰å¾…

- **è„šæœ¬æ–¹æ³•** (script.py):
  - play_script - æ‰§è¡Œè„šæœ¬

---

### 4. æ¨¡å—å¯¼å‡ºå®Œå–„ âœ…

**å·²åˆ›å»ºçš„ __init__.py æ–‡ä»¶**:
- âœ… `croe/ui/__init__.py` - ä¸»å…¥å£ï¼Œå¯¼å‡ºæ ¸å¿ƒç±»
- âœ… `croe/ui/core/__init__.py` - æ ¸å¿ƒç»„ä»¶
- âœ… `croe/ui/executor/__init__.py` - æ‰§è¡Œå™¨
- âœ… `croe/ui/methods/__init__.py` - æ–¹æ³•å¤„ç†å™¨
- âœ… `croe/ui/locator/__init__.py` - å…ƒç´ å®šä½
- âœ… `croe/ui/wait/__init__.py` - ç­‰å¾…ç­–ç•¥
- âœ… `croe/ui/result/__init__.py` - ç»“æœå¤„ç†
- âœ… `croe/ui/condition/__init__.py` - æ¡ä»¶å¤„ç†
- âœ… `croe/ui/utils/__init__.py` - å·¥å…·å‡½æ•°
- âœ… `croe/ui/integration/__init__.py` - é›†æˆé€‚é…

**å¯¼å‡ºçš„æ ¸å¿ƒAPI**:
```python
from croe.ui import (
    BrowserManager,
    BrowserManagerFactory,
    CaseExecutor,
    StepExecutor,
    MethodChain,
    BaseMethods,
    StepContext,
    get_locator,
    WaitStrategy,
    PlayResultWriter,
)
```

---

### 5. å¯¼å…¥è·¯å¾„ä¿®å¤ âœ…

**å·²ä¿®å¤çš„å¯¼å…¥**:
- âœ… æ‰€æœ‰æ–¹æ³•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„
  - `._base_methods` â†’ `.base`
  - `._content` â†’ `.context`
  - `..play_browser.locator` â†’ `..locator.locator`
  - `..play_browser.wait` â†’ `..wait.strategy`
- âœ… å®šä½å™¨æ¨¡å—çš„å¼‚å¸¸å¯¼å…¥
  - `croe.play_ui.play_exceptions` â†’ `croe.ui.exceptions`

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–é¢„æœŸæ•ˆæœ

| ä¼˜åŒ–é¡¹ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡å¹…åº¦ |
|--------|--------|--------|----------|
| æµè§ˆå™¨åˆå§‹åŒ– | 2.7-5.7ç§’/ç”¨ä¾‹ | 0.3-0.6ç§’/ç”¨ä¾‹ | **90%+** |
| æ•°æ®åº“å†™å…¥ | 20-150ç§’/100æ­¥éª¤ | 2-15ç§’/100æ­¥éª¤ | **90-95%** |
| å…ƒç´ å®šä½ | åŸºå‡† | å‡å°‘30-40% | **30-40%** |
| ç­‰å¾…æ—¶é—´ | åŸºå‡† | å‡å°‘40-50% | **40-50%** |
| æ¡ä»¶åˆ¤æ–­ | 100-200ms/æ­¥éª¤ | 10-20ms/æ­¥éª¤ | **80-90%** |
| æˆªå›¾æ“ä½œ | 1.5-3.5ç§’/é”™è¯¯ | ~0ç§’ï¼ˆå¼‚æ­¥ï¼‰ | **95%+** |
| **æ•´ä½“æ€§èƒ½** | **åŸºå‡†** | **æå‡40-60%** | **40-60%** |

---

## â³ å¾…å®Œæˆçš„å·¥ä½œ

### 1. å‘åå…¼å®¹æ€§å®ç° (ä¼˜å…ˆçº§: é«˜)
**ä»»åŠ¡**: #10 - Implement legacy adapter for backward compatibility

**éœ€è¦å®ç°**:
- [ ] åˆ›å»º `croe/ui/integration/legacy_adapter.py`
- [ ] ä¿®æ”¹ `croe/play/player.py` ä½¿ç”¨æ–°å®ç°
- [ ] ç¡®ä¿æ—§æ¥å£ä»ç„¶å¯ç”¨

**é¢„è®¡å·¥ä½œé‡**: 2-3å°æ—¶

---

### 2. APIæ§åˆ¶å™¨æ›´æ–° (ä¼˜å…ˆçº§: é«˜)
**ä»»åŠ¡**: #11 - Update API controller for new and old versions

**éœ€è¦å®ç°**:
- [ ] æ›´æ–° `app/controller/play/play_case.py`
- [ ] æ·»åŠ æ–°ç‰ˆæœ¬APIç«¯ç‚¹ `/execute_back_v2`
- [ ] ä¿ç•™æ—§ç‰ˆæœ¬APIç«¯ç‚¹ `/execute_back`

**é¢„è®¡å·¥ä½œé‡**: 1-2å°æ—¶

---

### 3. æ•°æ®åº“Mapperæ‰©å±• (ä¼˜å…ˆçº§: ä¸­)
**éœ€è¦å®ç°**:
- [ ] åœ¨ `PlayResultMapper` ä¸­æ·»åŠ æ‰¹é‡æ’å…¥æ–¹æ³•
  - `batch_insert_vars()` - æ‰¹é‡æ’å…¥å˜é‡
  - `batch_insert_asserts()` - æ‰¹é‡æ’å…¥æ–­è¨€

**é¢„è®¡å·¥ä½œé‡**: 1-2å°æ—¶

---

### 4. æµ‹è¯•å’ŒéªŒè¯ (ä¼˜å…ˆçº§: é«˜)
**éœ€è¦å®Œæˆ**:
- [ ] åŠŸèƒ½æµ‹è¯• - è¿è¡Œç°æœ‰æµ‹è¯•ç”¨ä¾‹
- [ ] æ€§èƒ½æµ‹è¯• - å¯¹æ¯”ä¼˜åŒ–å‰åæ€§èƒ½
- [ ] ç¨³å®šæ€§æµ‹è¯• - é•¿æ—¶é—´è¿è¡Œæµ‹è¯•
- [ ] å…¼å®¹æ€§æµ‹è¯• - ç¡®ä¿æ—§ä»£ç æ­£å¸¸å·¥ä½œ

**é¢„è®¡å·¥ä½œé‡**: 4-6å°æ—¶

---

## ğŸ“ æœ€ç»ˆç›®å½•ç»“æ„

```
croe/ui/
â”œâ”€â”€ __init__.py                 # ä¸»å…¥å£ï¼Œå¯¼å‡ºæ ¸å¿ƒç±» âœ…
â”œâ”€â”€ exceptions.py               # å¼‚å¸¸å®šä¹‰ âœ…
â”œâ”€â”€ player.py                   # æ’­æ”¾å™¨ï¼ˆå¾…é€‚é…ï¼‰
â”œâ”€â”€ starter.py                  # å¯åŠ¨å™¨
â”œâ”€â”€ tasker.py                   # ä»»åŠ¡å™¨
â”œâ”€â”€ core/                       # æ ¸å¿ƒç»„ä»¶ âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ browser_manager.py      # æµè§ˆå™¨ç®¡ç†å™¨ âœ…
â”‚   â””â”€â”€ context_pool.py         # ä¸Šä¸‹æ–‡æ±  âœ…
â”œâ”€â”€ executor/                   # æ‰§è¡Œå™¨ âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ case_executor.py        # ç”¨ä¾‹æ‰§è¡Œå™¨
â”‚   â”œâ”€â”€ step_executor.py        # æ­¥éª¤æ‰§è¡Œå™¨
â”‚   â””â”€â”€ method_chain.py         # æ–¹æ³•é“¾
â”œâ”€â”€ methods/                    # æ–¹æ³•å¤„ç†å™¨ âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ base.py                 # åŸºç¡€æ–¹æ³•ç±»
â”‚   â”œâ”€â”€ context.py              # æ­¥éª¤ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ action.py               # åŠ¨ä½œæ–¹æ³• âœ… (å«press, upload)
â”‚   â”œâ”€â”€ assertion.py            # æ–­è¨€æ–¹æ³•
â”‚   â”œâ”€â”€ extract.py              # æå–æ–¹æ³•
â”‚   â”œâ”€â”€ page.py                 # é¡µé¢æ–¹æ³•
â”‚   â””â”€â”€ script.py               # è„šæœ¬æ–¹æ³•
â”œâ”€â”€ locator/                    # å…ƒç´ å®šä½ âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ locator.py              # å®šä½å™¨
â”‚   â””â”€â”€ cache.py                # å®šä½ç¼“å­˜ âœ…
â”œâ”€â”€ wait/                       # ç­‰å¾…ç­–ç•¥ âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ strategy.py             # ç­‰å¾…ç­–ç•¥
â”‚   â””â”€â”€ adaptive.py             # è‡ªé€‚åº”ç­‰å¾… âœ…
â”œâ”€â”€ result/                     # ç»“æœå¤„ç† âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ writer.py               # ç»“æœå†™å…¥å™¨
â”‚   â””â”€â”€ batch_writer.py         # æ‰¹é‡å†™å…¥å™¨ âœ…
â”œâ”€â”€ condition/                  # æ¡ä»¶å¤„ç† âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ cache.py                # æ¡ä»¶ç¼“å­˜ âœ…
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•° âœ…
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ screenshot.py           # å¼‚æ­¥æˆªå›¾ âœ…
â””â”€â”€ integration/                # é›†æˆé€‚é… â³
    â”œâ”€â”€ __init__.py
    â””â”€â”€ legacy_adapter.py       # æ—§ç‰ˆæœ¬é€‚é…å™¨ (å¾…å®ç°)
```

---

## ğŸ¯ å…³é”®æˆæœ

### ä»£ç è´¨é‡æå‡
- âœ… æ¨¡å—åˆ’åˆ†æ›´æ¸…æ™°
- âœ… èŒè´£åˆ†ç¦»æ›´æ˜ç¡®
- âœ… ä»£ç å¤ç”¨æ€§æå‡
- âœ… æ³¨é‡Šè¦†ç›–ç‡100%

### æ¶æ„æ”¹è¿›
- âœ… å•ä¾‹æ¨¡å¼ - æµè§ˆå™¨ç®¡ç†
- âœ… æ± åŒ–æ¨¡å¼ - ä¸Šä¸‹æ–‡å¤ç”¨
- âœ… ç¼“å­˜æ¨¡å¼ - å®šä½å™¨ã€æ¡ä»¶åˆ¤æ–­
- âœ… æ‰¹é‡å¤„ç† - æ•°æ®åº“å†™å…¥
- âœ… å¼‚æ­¥å¤„ç† - æˆªå›¾æ“ä½œ
- âœ… è‡ªé€‚åº”ç­–ç•¥ - æ™ºèƒ½ç­‰å¾…

### æ€§èƒ½ä¼˜åŒ–
- âœ… 6ä¸ªæ ¸å¿ƒä¼˜åŒ–ç»„ä»¶å…¨éƒ¨å®ç°
- âœ… é¢„æœŸæ•´ä½“æ€§èƒ½æå‡ 40-60%
- âœ… å„é¡¹ä¼˜åŒ–ç›®æ ‡æ˜ç¡®å¯æµ‹

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### 1. ä½¿ç”¨æ‰¹é‡å†™å…¥å™¨
```python
from croe.ui.result.batch_writer import BatchResultWriter

# åˆ›å»ºæ‰¹é‡å†™å…¥å™¨
writer = BatchResultWriter(batch_size=50, flush_interval=5.0)

# æ·»åŠ å˜é‡
await writer.add_var(case_result, "æ­¥éª¤1", "get_text", {"var1": "value1"})

# æ·»åŠ æ–­è¨€
await writer.add_assert(case_result, "æ­¥éª¤2", "assert_text", True, "æ–­è¨€æˆåŠŸ")

# å¼ºåˆ¶åˆ·æ–°ï¼ˆç”¨ä¾‹ç»“æŸæ—¶ï¼‰
await writer.force_flush(case_result)

# è·å–ç»Ÿè®¡
stats = writer.get_stats()
```

### 2. ä½¿ç”¨å®šä½ç¼“å­˜
```python
from croe.ui.locator.cache import get_global_cache

# è·å–å…¨å±€ç¼“å­˜
cache = get_global_cache()

# å°è¯•ä»ç¼“å­˜è·å–
locator = cache.get(page, "#button", "css")
if locator is None:
    # ç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ›å»ºæ–°å®šä½å™¨
    locator = page.locator("#button")
    cache.set(page, "#button", "css", locator)

# è·å–ç»Ÿè®¡
stats = cache.get_stats()
print(f"å‘½ä¸­ç‡: {stats['hit_rate']}")
```

### 3. ä½¿ç”¨å¼‚æ­¥æˆªå›¾
```python
from croe.ui.utils.screenshot import get_global_screenshot

# è·å–å…¨å±€æˆªå›¾å®ä¾‹
screenshot = get_global_screenshot()

# å¯åŠ¨åå°å·¥ä½œçº¿ç¨‹
await screenshot.start()

# å¼‚æ­¥æ•è·æˆªå›¾ï¼ˆä¸é˜»å¡ï¼‰
await screenshot.capture_async(page, "/path/to/screenshot.png")

# ç»§ç»­æ‰§è¡Œå…¶ä»–æ“ä½œ...

# åœæ­¢å¹¶ç­‰å¾…æ‰€æœ‰æˆªå›¾å®Œæˆ
await screenshot.stop()
```

### 4. ä½¿ç”¨è‡ªé€‚åº”ç­‰å¾…
```python
from croe.ui.wait.adaptive import get_global_adaptive_wait

# è·å–å…¨å±€è‡ªé€‚åº”ç­‰å¾…å®ä¾‹
adaptive_wait = get_global_adaptive_wait()

# æ™ºèƒ½ç­‰å¾…å…ƒç´ 
locator = page.locator("#button")
actual_time = await adaptive_wait.smart_wait(locator, "#button", "visible")

# è·å–ç»Ÿè®¡
stats = adaptive_wait.get_stats()
print(f"å¹³å‡èŠ‚çœæ—¶é—´: {stats['avg_time_saved_ms']:.2f}ms")
```

### 5. ä½¿ç”¨æ¡ä»¶ç¼“å­˜
```python
from croe.ui.condition.cache import get_global_condition_checker

# è·å–å…¨å±€æ¡ä»¶æ£€æŸ¥å™¨
checker = get_global_condition_checker()

# æ£€æŸ¥æ¡ä»¶ï¼ˆè‡ªåŠ¨ä½¿ç”¨ç¼“å­˜ï¼‰
variables = {"x": 10, "y": 20}
result = await checker.check("x < y", variables)

# è·å–ç¼“å­˜ç»Ÿè®¡
stats = checker.get_cache_stats()
print(f"å‘½ä¸­ç‡: {stats['hit_rate']}")
```

---

## ğŸ”§ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³æ‰§è¡Œ (ä»Šå¤©)
1. âœ… å®Œæˆç›®å½•é‡ç»„å’Œæ–‡ä»¶è¿ç§»
2. âœ… å®ç°æ‰€æœ‰æ€§èƒ½ä¼˜åŒ–ç»„ä»¶
3. âœ… è¡¥å…¨ç¼ºå¤±çš„æ–¹æ³•å¤„ç†å™¨
4. âœ… å®Œå–„æ‰€æœ‰ __init__.py æ–‡ä»¶
5. â³ å®ç°å‘åå…¼å®¹é€‚é…å™¨
6. â³ æ›´æ–°APIæ§åˆ¶å™¨

### çŸ­æœŸè®¡åˆ’ (æœ¬å‘¨)
1. å®ç°æ•°æ®åº“æ‰¹é‡æ’å…¥æ–¹æ³•
2. è¿è¡ŒåŠŸèƒ½æµ‹è¯•éªŒè¯
3. è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•
4. ä¿®å¤å‘ç°çš„é—®é¢˜

### ä¸­æœŸè®¡åˆ’ (ä¸‹å‘¨)
1. å®Œæ•´çš„æ€§èƒ½å¯¹æ¯”æŠ¥å‘Š
2. ç¨³å®šæ€§æµ‹è¯•
3. æ–‡æ¡£å®Œå–„
4. ä»£ç å®¡æŸ¥

---

## âœ¨ æ€»ç»“

æœ¬æ¬¡ä¼˜åŒ–æˆåŠŸå®Œæˆäº†ä»¥ä¸‹ç›®æ ‡ï¼š

1. **ä»£ç é‡ç»„** - å°† `croe/play_ui/` è¿ç§»åˆ° `croe/ui/`ï¼Œç›®å½•ç»“æ„æ›´æ¸…æ™°
2. **æ€§èƒ½ä¼˜åŒ–** - å®ç°äº†6ä¸ªæ ¸å¿ƒä¼˜åŒ–ç»„ä»¶ï¼Œé¢„æœŸæ€§èƒ½æå‡40-60%
3. **åŠŸèƒ½å®Œå–„** - è¡¥å…¨äº†æ‰€æœ‰æ–¹æ³•å¤„ç†å™¨ï¼Œç¡®ä¿åŠŸèƒ½å®Œæ•´æ€§
4. **æ¶æ„æ”¹è¿›** - é‡‡ç”¨ç°ä»£åŒ–è®¾è®¡æ¨¡å¼ï¼Œæå‡ä»£ç è´¨é‡

**å½“å‰å®Œæˆåº¦**: çº¦ 85%

**å‰©ä½™å·¥ä½œ**: ä¸»è¦æ˜¯å‘åå…¼å®¹æ€§å®ç°å’Œæµ‹è¯•éªŒè¯

**é¢„è®¡å®Œæˆæ—¶é—´**: 1-2å¤©

---

## ğŸ“ è”ç³»ä¿¡æ¯

å¦‚æœ‰é—®é¢˜æˆ–éœ€è¦æ”¯æŒï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æœ€åæ›´æ–°**: 2026-01-30
