#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2024/7/23# @Author : cyq# @File : jsonPathUtil# @Software: PyCharm# @Desc:from typing import Anyfrom jsonpath import jsonpathfrom json import JSONDecodeErrorclass MyJsonPath:    def __init__(self, jsonBody: Any, expr: str):        """        :param jsonBody Response.json        :param expr        """        self.jsonBody = jsonBody        self.endStr = None        self.expr = self.handel_expr(expr)    async def value(self) -> Any:        """        jsonpath 解析        :return: Any        """        try:            result = jsonpath(self.jsonBody, self.expr)            if result:                if self.endStr:                    return self.funcMap(result[0])                return result[0]            else:                return None        # 可能不是json        except JSONDecodeError as e:            raise e    def handel_expr(self, expr: str) -> str:        """        """        expr= expr.strip()        if expr.endswith("()"):            self.endStr = expr.split(".")[-1]            new = expr.replace("." + self.endStr, "")            return new        return expr    def funcMap(self, data):        """        jsonpath 增加长度        $.data.length()        """        func_Map = {            "length()": len        }        func = func_Map.get(self.endStr)        if func:            if data:                return func(data)        return data