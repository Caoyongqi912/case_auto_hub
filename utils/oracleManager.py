#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2024/8/27# @Author : cyq# @File : oracleManager# @Software: PyCharm# @Desc:from typing import Mapping, Optional, List, Tuple# import cx_Oraclefrom utils import loginfo = {}host=""class OracleManager:    def __init__(self):        service_name = info.get("service_name")        port = 1521        # dsn = cx_Oracle.makedsn(host, port, service_name=service_name)        # cx_Oracle.init_oracle_client(lib_dir="/Users/cyq/Downloads/instantclient_23_3")        try:            # self.con = cx_Oracle.connect(user=info['username'],            #                              password=info['password'],            #                              dsn=dsn,            #                              )            self.con = None            self.cursor = self.con.cursor()        except Exception as e:            error, = e.args            print("Oracle-Error-Code:", error.code)            print("Oracle-Error-Message:", error.message)            raise e    def execute_sql(self, sql: str) -> Optional[None]:        """        执行sql        """        try:            log.info(f"execute sql = {sql}")            self.cursor.execute(sql)            self.con.commit()        except Exception as e:            log.exception(e)            self.con.rollback()            raise e    def fetch_sql(self, sql: str) -> List[Tuple]:        """        查询        """        try:            log.info(f"execute sql = {sql}")            self.cursor.execute(sql)            return self.cursor.fetchone()        except cx_Oracle.Error as e:            raise e