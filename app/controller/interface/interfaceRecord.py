#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2024/12/25# @Author : cyq# @File : interfaceRecord# @Software: PyCharm# @Desc:import asynciofrom fastapi import APIRouterfrom playwright.async_api import Playwright, async_playwrightfrom app.response import Responserouter = APIRouter(prefix="/interface/record", tags=['接口录制'])@router.get("/start")async def start():    asyncio.create_task(main())    return Response.success()async def main():    async with async_playwright() as playwright:        await run(playwright)async def run(playwright: Playwright):    chromium = playwright.chromium  # or "firefox" or "webkit".    browser = await chromium.launch(headless=False)    page = await browser.new_page()    # 打印请求和响应    page.on("request", log_request)    await page.goto("https://aijia-test.5i5j.com/home")    # await page.wait_for_timeout(5000)    # other actions...    await page.wait_for_event("close",timeout=1000*60*5*24)    await page.close()    await browser.close()# 打印请求的详细信息def log_request(request):    resource_type = request.resource_type    # 如果是 xhr 或 fetch 请求，跳过    if resource_type not in ["xhr", "fetch"]:        return    url = request.url    method = request.method    headers = request.headers    post_data = request.post_data  # 如果有请求体数据    print(f"Request URL: {url}")    print(f"Request Method: {method}")    print(f"Request Headers: {headers}")    print(f"Request Body: {post_data}")    print("-" * 80)  # 分隔线，便于查看不同请求