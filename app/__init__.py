#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2024/6/6# @Author : cyq# @File : __init__.py# @Software: PyCharm# @Desc:from fastapi import FastAPIfrom fastapi.exceptions import RequestValidationErrorfrom starlette.middleware.base import BaseHTTPMiddlewarefrom starlette.middleware.errors import ServerErrorMiddlewarefrom starlette.middleware.cors import CORSMiddlewarefrom app.middware import CORS_ALLOW_ORIGINS, req_middleware, error_middleware, validation_exception_handlerfrom app.controller import RegisterRouterListfrom app.ws.ws import managerfrom app.ws import io, apphub = FastAPI(    title="CaseAutoHub")# 加载路由for item in RegisterRouterList:    hub.include_router(item.router)# 参数校验捕获hub.add_exception_handler(    RequestValidationError,    handler=validation_exception_handler,)# 跨域hub.add_middleware(    CORSMiddleware,    **CORS_ALLOW_ORIGINS)# 请求日志hub.add_middleware(    BaseHTTPMiddleware,    dispatch=req_middleware,)# 全局异常捕获hub.add_middleware(    ServerErrorMiddleware,    handler=error_middleware,)hub.mount("/ws", app)hub.sio = io