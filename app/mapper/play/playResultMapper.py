#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2026/2/3# @Author : cyq# @File : playResultMapper# @Software: PyCharm# @Desc:from typing import Listfrom app.model import async_sessionfrom app.model.playUI.PlayResult import PlayStepContentResultfrom app.mapper import Mapperfrom utils import logclass PlayContentResultMapper(Mapper[PlayStepContentResult]):    __model__ = PlayStepContentResult    @classmethod    async def set_result(cls, result: PlayStepContentResult):        try:            async with async_session() as session:                async with session.begin():                    await cls.add_flush_expunge(session, result)        except Exception as e:            log.error(e)            raise e    @classmethod    async def save_result_batch(cls, results: List[PlayStepContentResult])->int:        """        批量插入        """        try:            async with async_session() as session:                session.add_all(results)                await session.commit()            log.info(f"[PlayContentResultMapper] Batch inserted {len(results)} results")            return len(results)        except Exception as e:            raise