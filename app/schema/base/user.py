#!/usr/bin/env python# -*- coding:utf-8 -*-# @Time : 2024/6/15# @Author : cyq# @File : user# @Software: PyCharm# @Desc:from typing import Unionfrom pydantic import BaseModel, field_validator, Fieldfrom app.schema import PageSchemafrom enums.UserEnum import GenderEnumfrom app.exception import ParamsErrorimport re__call__ = [    "RegisterUser",    "UserOptSchema",    "RegisterAdmin",    "UpdateUserSchema",    "PasswordUserSchema",    "LoginUser",    "UserVars",    "PageUserVars",    "QueryUserVars",    "AddOrUpdateUserVars"]class RegisterUser(BaseModel):    username: str = Field(..., title='用户名', description='用户名', max_length=20)    gender: GenderEnum = Field(default=GenderEnum.MALE, title='性别', description='性别')    phone: str = Field(..., title='手机号', description='手机号', max_length=11)    tagName: str | None = Field(..., title='标签名', description='标签名')    depart_id: Union[int, None] = Field(..., title='部门ID', description='部门ID')    depart_name: Union[str, None] = Field(..., title='部门', description='部门')    isAdmin: Union[bool, None] = Field(False, title='是否管理员', description='是否管理员')    @field_validator('phone')    @classmethod    def check_phone(cls, v: str):        par = "^((13[0-9])|(14)|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199|(147))\\d{8}$"        res = re.match(par, v.strip())        if not res:            raise ParamsError('手机号格式错误')        return vclass UserOptSchema(BaseModel):    userId: intclass RegisterAdmin(BaseModel):    username: strclass UpdateUserSchema(BaseModel):    id: int    username: str | None = None    phone: str | None = None    gender: GenderEnum | None = None    depart_id: int | None = None    depart_name:str|None = Noneclass PasswordUserSchema(BaseModel):    new_password: str    old_password: strclass LoginUser(BaseModel):    username: str    password: strclass UserVars(BaseModel):    key: str    value: str    description: str | None = Field(None)class AddOrUpdateUserVars(UserVars):    id: int | None = Field(None)